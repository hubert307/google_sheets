<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é‡‘èåœ–è¡¨ - Powered by Hubert.</title>
    <style>
        /* ============================================================
           1. å…¨åŸŸè®Šæ•¸å®šç¾© (CSS Variables)
           ============================================================ */
        :root {
            --bg-color: #0f172a;       /* é é¢èƒŒæ™¯è‰² */
            --chart-bg: #111827;       /* åœ–è¡¨å®¹å™¨èƒŒæ™¯è‰² */
            --card-bg: #1e293b;        /* æŒ‰éˆ•é è¨­èƒŒæ™¯è‰² */
            --primary: #38bdf8;        /* ä¸»é¡Œè—è‰² (Active ç‹€æ…‹) */
            --primary-glow: rgba(56, 189, 248, 0.3);
            --text-main: #f8fafc;      /* ä¸»è¦æ–‡å­—é¡è‰² */
            --text-dim: #94a3b8;       /* æ¬¡è¦/æš—æ·¡æ–‡å­—é¡è‰² */
            
            /* æ²è»¸é¡è‰²è‡ªå®šç¾© (æš—è‰²ç³») */
            --scrollbar-track: #0f172a;
            --scrollbar-thumb: #334155;
            --scrollbar-thumb-hover: #475569;
        }

        /* ============================================================
           2. æ²è»¸æ¨£å¼ä¿®æ­£ (Cross-browser Scrollbar)
           ============================================================ */
        /* Firefox æ²è»¸æ”¯æ´ */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
        }

        /* Chrome, Edge, Safari (Webkit) æ²è»¸æ”¯æ´ */
        ::-webkit-scrollbar {
            width: 6px;  /* å‚ç›´æ²è»¸å¯¬åº¦ */
            height: 6px; /* æ°´å¹³æ²è»¸é«˜åº¦ */
        }

        ::-webkit-scrollbar-track {
            background: var(--scrollbar-track);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover);
        }

        /* ============================================================
           3. åŸºç¤ä½ˆå±€è¨­è¨ˆ
           ============================================================ */
        body {
            background-color: var(--bg-color);
            margin: 0; padding: 20px;
            font-family: 'Inter', -apple-system, 'Microsoft JhengHei', sans-serif;
            color: var(--text-main);
            height: 100vh;             /* å¼·åˆ¶å……æ»¿è¦–çª—é«˜åº¦ */
            display: flex; 
            flex-direction: column;
            box-sizing: border-box;
            overflow: hidden;          /* é˜²æ­¢ body å‡ºç¾æ²è»¸ */
            user-select: none;         /* ç¦æ­¢åç™½æ–‡å­— */
            -webkit-user-select: none;
        }

        /* ä¸»ç¶²æ ¼ä½ˆå±€ï¼šå´é‚Šæ¬„ + åœ–è¡¨å€ */
        .main-layout {
            display: grid;
            grid-template-columns: 220px 1fr; /* å´é‚Šæ¬„å¯¬åº¦å›ºå®š 220px */
            gap: 20px;
            flex-grow: 1;              /* å¡«æ»¿å‰©é¤˜ç©ºé–“ */
            min-height: 0;             /* é—œéµï¼šé˜²æ­¢å…§å®¹æ’é–‹é«˜åº¦å°è‡´æº¢å‡º */
        }

        /* å´é‚Šæ¬„ï¼šæŒ‰éˆ•æ¸…å–® */
        .sidebar {
            display: flex; 
            flex-direction: column;
            gap: 8px; 
            overflow-y: auto;          /* æŒ‰éˆ•éå¤šæ™‚å¯å‚ç›´æ»¾å‹• */
            padding-right: 8px;
        }

        /* åˆ†é æŒ‰éˆ•æ¨£å¼ */
        .tab-btn {
            background-color: var(--card-bg);
            color: var(--text-dim);
            border: 1px solid rgba(255,255,255,0.05);
            padding: 0 16px; 
            min-height: 44px; 
            border-radius: 10px;
            cursor: pointer; 
            font-size: 0.85rem;
            text-align: left;
            display: flex; 
            align-items: center;
            transition: all 0.25s ease;
            white-space: nowrap;
            touch-action: manipulation;
        }

        /* æŒ‰éˆ•é¸ä¸­ç‹€æ…‹ (Active) */
        .tab-btn.active {
            background: linear-gradient(135deg, #7dd3fc 0%, var(--primary) 100%);
            color: #0f172a; 
            font-weight: 800; 
            transform: translateX(5px); /* é¸ä¸­æ™‚å‘å³å¾®å */
            box-shadow: 0 4px 12px var(--primary-glow);
        }

        /* ============================================================
           4. åœ–è¡¨é¡¯ç¤ºå€æ¨£å¼
           ============================================================ */
        .chart-wrapper {
            background: var(--chart-bg);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            height: 100%;
            position: relative;        /* ç‚ºäº†è®“æµ®æ°´å° Overlay èƒ½çµ•å°å®šä½æ–¼æ­¤ */
            overflow: hidden;
        }

        /* åœ–è¡¨æ²å‹•å®¹å™¨ï¼šæ§åˆ¶ iframe çš„æº¢å‡ºèˆ‡é¡¯ç¤º */
        .iframe-scroll-container {
            width: 100%; 
            height: 100%;
            overflow-y: auto; 
            overflow-x: hidden;
            position: relative; 
            z-index: 1;
            display: none;             /* é è¨­éš±è— */
        }

        /* ç•¶å‰æ´»å‹•ä¸­çš„å®¹å™¨ */
        .iframe-scroll-container.active-container {
            display: block;
        }

        /* æµ®æ°´å°å±¤ (é˜²ç›œç”¨ & è¼‰å…¥æç¤º) */
        .glass-overlay, .glass-overlayW {
            position: absolute;
            top: 0; left: 0; 
            width: 100%; height: 100%;
            z-index: 100;              /* ä½æ–¼ iframe ä¹‹ä¸Š */
            pointer-events: auto;      /* æ¥æ”¶æ»‘é¼ äº‹ä»¶ä»¥è™•ç†æ²å‹•å‚³é */
            background-repeat: repeat;
            transition: opacity 0.4s ease;
        }

        /* æ·±è‰²åœ–è¡¨å°ˆç”¨æµ®æ°´å° (SVG èƒŒæ™¯) */
        .glass-overlay {
            background-image: url("data:image/svg+xml,...");
        }
        
        /* å…¶ä»–åœ–è¡¨å°ˆç”¨æµ®æ°´å° (ç°è‰²å­—) */
        .glass-overlayW {
            background-image: url("data:image/svg+xml,...");
        }

        iframe {
            width: 100%; 
            height: 1600px;            /* è¨­å®šè¼ƒå¤§çš„é«˜åº¦ä»¥ç¢ºä¿ Google è©¦ç®—è¡¨å…§å®¹å®Œæ•´ */
            border: none; 
            display: block; 
            background: #111827;
        }

        /* åˆ‡æ›åˆ†é çš„é¡¯ç¤ºé‚è¼¯ */
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* ============================================================
           5. éŸ¿æ‡‰å¼è¨­è¨ˆ (Mobile Responsive)
           ============================================================ */
        @media (max-width: 768px) {
            body { padding: 10px; overflow: hidden; }

            /* æ‰‹æ©Ÿç‰ˆæ”¹ç‚ºä¸Šä¸‹ä½ˆå±€ï¼šæŒ‰éˆ•åœ¨ä¸Šï¼Œåœ–è¡¨åœ¨ä¸‹ */
            .main-layout { 
                grid-template-columns: 1fr; 
                grid-template-rows: auto 1fr; 
                gap: 12px; 
            }

            /* æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„æ”¹ç‚ºæ°´å¹³æ©«å‘æ²å‹• */
            .sidebar { 
                flex-direction: row; 
                padding-bottom: 8px; 
                overflow-x: auto; 
                -webkit-overflow-scrolling: touch; 
            }
            .sidebar::-webkit-scrollbar { height: 4px; } /* æ©«å‘æ²è»¸é«˜åº¦ */
            
            .tab-btn { min-height: 38px; padding: 0 12px; font-size: 0.8rem; border-radius: 8px; }
            
            /* æ‰‹æ©Ÿç‰ˆå…è¨±å·¦å³æ²å‹•æŸ¥çœ‹å®Œæ•´å¯¬åº¦åœ–è¡¨ */
            .iframe-scroll-container {
                overflow-x: auto !important; 
                -webkit-overflow-scrolling: touch;
            }

            /* å¼·åˆ¶æ’é–‹å¯¬åº¦ï¼Œè§£æ±º Google åœ–è¡¨åœ–ä¾‹è¢«åˆ‡æ‰çš„å•é¡Œ */
            .tab-content.active {
                display: block;
                width: 2200px; 
                padding-right: 60px; 
            }

            iframe, .glass-overlay, .glass-overlayW {
                width: 2200px !important;
            }

            iframe { height: 1200px; } /* æ‰‹æ©Ÿç‰ˆé™ä½é«˜åº¦ä»¥åˆ©æ“ä½œ */
        }
    </style>
</head>
<body oncontextmenu="return false" ondragstart="return false">

<div class="main-layout">
    <div class="sidebar">
        <button class="tab-btn active" onclick="openTab(event, 'c1')">ğŸ“Š 2026 å«æ¯å ±é…¬</button>
        <button class="tab-btn" onclick="openTab(event, 'c2')">ğŸ“ˆ ç©>40% å«æ¯å ±é…¬</button>
        <button class="tab-btn" onclick="openTab(event, 'c16')">ğŸ†š 00981A vs 2330</button>
    </div>

    <div class="chart-wrapper">
        <div class="iframe-scroll-container active-container" id="scrollContainer">
            <div class="glass-overlay" id="overlayA"></div>
            <div id="c1" class="tab-content active">
                <iframe src="https://docs.google.com/spreadsheets/d/e/..."></iframe>
            </div>
            </div>

        <div class="iframe-scroll-container" id="scrollContainerW">
            <div class="glass-overlayW" id="overlayB"></div>
            <div id="c11" class="tab-content">
                <iframe src="https://docs.google.com/spreadsheets/d/e/..."></iframe>
            </div>
            </div>
    </div>
</div>

<script>
    /* ============================================================
       6. JavaScript äº¤äº’é‚è¼¯
       ============================================================ */
    
    const containerA = document.getElementById('scrollContainer');
    const containerB = document.getElementById('scrollContainerW');

    /**
     * è™•ç†æ²å‹•å‚³éï¼š
     * ç”±æ–¼æµ®æ°´å°å±¤ (Overlay) åœ¨ iframe ä¹‹ä¸Šï¼Œæœƒæ””æˆªæ»‘é¼ æ²å‹•ã€‚
     * æ­¤å‡½æ•¸æ•æ‰ Overlay çš„æ²å‹•äº‹ä»¶ï¼Œæ‰‹å‹•å°‡ä½ç§»é‡å¥—ç”¨åˆ°ä¸‹æ–¹çš„å®¹å™¨ã€‚
     */
    const handleWheel = (e, container) => {
        container.scrollTop += e.deltaY;
        container.scrollLeft += e.deltaX;
        e.preventDefault(); // é˜²æ­¢ç¶²é æ•´é«”æ²å‹•
    };

    // ç¶å®šæ²å‹•ç›£è½
    document.getElementById('overlayA').addEventListener('wheel', (e) => handleWheel(e, containerA), { passive: false });
    document.getElementById('overlayB').addEventListener('wheel', (e) => handleWheel(e, containerB), { passive: false });

    /**
     * åˆ‡æ›åˆ†é é‚è¼¯
     * @param {Event} evt - é»æ“Šäº‹ä»¶
     * @param {string} chartId - è¦é¡¯ç¤ºçš„åœ–è¡¨ ID
     */
    function openTab(evt, chartId) {
        // 1. æ¸…é™¤æ‰€æœ‰åˆ†é èˆ‡æŒ‰éˆ•çš„æ´»å‹•ç‹€æ…‹
        document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
        document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));

        // 2. åˆ¤æ–·ç›®æ¨™å±¬æ–¼å“ªä¸€å€‹å¤§å®¹å™¨ (A çµ„æˆ– B çµ„)
        const isGroupB = ['c11', 'c12', 'c13', 'c14', 'c15', 'c16'].includes(chartId);
        const targetContainer = isGroupB ? containerB : containerA;
        const otherContainer = isGroupB ? containerA : containerB;

        // 3. åˆ‡æ›å®¹å™¨é¡¯ç¤º
        otherContainer.classList.remove("active-container");
        targetContainer.classList.add("active-container");
        
        // 4. é‡ç½®æ²å‹•ä½ç½®åˆ°æœ€é ‚ç«¯
        targetContainer.scrollTop = 0;
        targetContainer.scrollLeft = 0;

        // 5. é¡¯ç¤ºç›®æ¨™åˆ†é å…§å®¹ä¸¦é«˜äº®æŒ‰éˆ•
        document.getElementById(chartId).classList.add("active");
        evt.currentTarget.classList.add("active");

        // 6. æ‰‹æ©Ÿç‰ˆå„ªåŒ–ï¼šé»æ“ŠæŒ‰éˆ•å¾Œè‡ªå‹•å°‡è©²æŒ‰éˆ•ç½®ä¸­é¡¯ç¤º
        if (window.innerWidth <= 768) {
            evt.currentTarget.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
        }
    }
</script>

</body>
</html>
